test:cargo:
  image: rust:1.80  # Use a pinned Rust Docker image for reproducibility
  variables:
    CARGO_TERM_COLOR: always
    RUST_BACKTRACE: full
    RUSTUP_HOME: /usr/local/rustup
    CARGO_HOME: /usr/local/cargo
  cache:
    key: "$CI_JOB_NAME"
    paths:
      - target
      - /usr/local/cargo/registry
      - /usr/local/cargo/git
  before_script:
    - rustup show
    - rustup default nightly-2025-01-15
  script:
    - cargo fetch
    - cargo build --locked --bin mech --release
    - cargo test --locked interpret
